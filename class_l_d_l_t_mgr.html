<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>LDLTMgr class | EllAlgo</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">EllAlgo</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li>
              <a href="pages.html">Pages</a>
              <ol>
                <li><a href="about.html">About</a></li>
              </ol>
            </li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          LDLTMgr <span class="m-thin">class</span>
          <div class="m-doc-include m-code m-inverted m-text-right"><span class="cp">#include</span> <a class="cpf" href="ldlt__mgr_8hpp.html">&lt;ellalgo/oracles/ldlt_mgr.hpp&gt;</a></div>
        </h1>
        <p>LDLT factorization.</p>
        <nav class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
                <li><a href="#pub-attribs">Public variables</a></li>
              </ul>
            </li>
          </ul>
        </nav>
<p><code><a href="class_l_d_l_t_mgr.html" class="m-doc">LDLTMgr</a></code> is a class that performs the LDLT factorization for a given symmetric matrix. The LDLT factorization decomposes a symmetric matrix A into the product of a lower triangular matrix L, a diagonal matrix D, and the transpose of L. This factorization is useful for solving linear systems and eigenvalue problems. The class provides methods to perform the factorization, check if the matrix is positive definite, calculate a witness vector if it is not positive definite, and calculate the symmetric quadratic form.</p><ul><li>LDL^T square-root-free version</li><li>Option allow semidefinite</li><li>A matrix A in R^{m x m} is positive definite iff v&#x27; A v &gt; 0 for all v in R^n.</li><li>O(p^2) per iteration, independent of N</li></ul>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a43322b727396f7fbc3ef48eeac133096" class="m-doc">LDLTMgr</a>(</span><span class="m-doc-wrap">size_t N) <span class="m-label m-flat m-info">explicit</span> </span>
            </dt>
            <dd>Construct a new ldlt ext object.</dd>
            <dt id="a2ce9d8ddc0b81c073037b545fae6e2e3">
              <span class="m-doc-wrap-bumper"><a href="#a2ce9d8ddc0b81c073037b545fae6e2e3" class="m-doc-self">LDLTMgr</a>(</span><span class="m-doc-wrap">const <a href="class_l_d_l_t_mgr.html" class="m-doc">LDLTMgr</a>&amp;) <span class="m-label m-flat m-danger">deleted</span></span>
            </dt>
            <dd><span></span></dd>
            <dt id="a189af948cc280cea59674433317c1fca">
              <span class="m-doc-wrap-bumper"><a href="#a189af948cc280cea59674433317c1fca" class="m-doc-self">LDLTMgr</a>(</span><span class="m-doc-wrap"><a href="class_l_d_l_t_mgr.html" class="m-doc">LDLTMgr</a>&amp;&amp;) <span class="m-label m-flat m-info">defaulted</span></span>
            </dt>
            <dd><span></span></dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt id="a1b346173191ab42aa0360207391bb73d">
              <span class="m-doc-wrap-bumper">auto <a href="#a1b346173191ab42aa0360207391bb73d" class="m-doc-self">operator=</a>(</span><span class="m-doc-wrap">const <a href="class_l_d_l_t_mgr.html" class="m-doc">LDLTMgr</a>&amp;) -&gt; <a href="class_l_d_l_t_mgr.html" class="m-doc">LDLTMgr</a>&amp; <span class="m-label m-flat m-danger">deleted</span></span>
            </dt>
            <dd><span></span></dd>
            <dt>
              <div class="m-doc-template">template&lt;typename Mat&gt;</div>
              <span class="m-doc-wrap-bumper">auto <a href="#a2af45dc9628f487ab821aff6f3fc0794" class="m-doc">factorize</a>(</span><span class="m-doc-wrap">const Mat&amp; A) -&gt; bool -&gt; auto</span>
            </dt>
            <dd>Perform LDLT Factorization.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a9a0315be1e868d82b607be9feb3c1f47" class="m-doc">factor</a>(</span><span class="m-doc-wrap">std::function&lt;double(size_t, size_t)&gt; get_matrix_elem) -&gt; bool -&gt; auto</span>
            </dt>
            <dd>Perform LDLT Factorization (Lazy evaluation)</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#afc994e7c46e9c9bd159ab066e8393c24" class="m-doc">factor_with_allow_semidefinite</a>(</span><span class="m-doc-wrap">std::function&lt;double(size_t, size_t)&gt; get_matrix_elem) -&gt; bool -&gt; auto</span>
            </dt>
            <dd>Perform LDLT Factorization (Lazy evaluation)</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a0a2d047ce3d930da880474c9a4aff9f2" class="m-doc">is_spd</a>(</span><span class="m-doc-wrap">) const noexcept -&gt; bool -&gt; auto</span>
            </dt>
            <dd>Is $A$ symmetric positive definite (spd)</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a0c2f0d8bd99e16c64103b5d1da966dcb" class="m-doc">witness</a>(</span><span class="m-doc-wrap">) -&gt; double -&gt; auto</span>
            </dt>
            <dd>witness that certifies $A$ is not symmetric positive definite (spd)</dd>
            <dt>
              <div class="m-doc-template">template&lt;typename Arr036&gt;</div>
              <span class="m-doc-wrap-bumper">auto <a href="#a3a8724268ebae4c5a9183f8acb0742f1" class="m-doc">set_witness_vec</a>(</span><span class="m-doc-wrap">Arr036&amp; v) const -&gt; void -&gt; auto</span>
            </dt>
            <dd>Set the witness vec object.</dd>
            <dt>
              <div class="m-doc-template">template&lt;typename Mat&gt;</div>
              <span class="m-doc-wrap-bumper">auto <a href="#af67c2bccbf77125b4f7a2daa15a05024" class="m-doc">sym_quad</a>(</span><span class="m-doc-wrap">const Mat&amp; A) const -&gt; double -&gt; auto</span>
            </dt>
            <dd>Calculate v&#x27;*{A}(p,p)*v.</dd>
            <dt>
              <div class="m-doc-template">template&lt;typename Mat&gt;</div>
              <span class="m-doc-wrap-bumper">auto <a href="#a7bbba061b1b4ded4cdfca5bf55f3068b" class="m-doc">sqrt</a>(</span><span class="m-doc-wrap">Mat&amp; M) -&gt; void -&gt; auto</span>
            </dt>
            <dd>Return upper triangular matrix $R$ where $A = R^T R$.</dd>
          </dl>
        </section>
        <section id="pub-attribs">
          <h2><a href="#pub-attribs">Public variables</a></h2>
          <dl class="m-doc">
            <dt id="a84c05debb0d72d3513543aa0b7ff04f5">
              Rng <a href="#a84c05debb0d72d3513543aa0b7ff04f5" class="m-doc-self">p</a>
            </dt>
            <dd>the rows where the process starts and stops</dd>
            <dt id="ae5b03da1529a27964723627bceb43166">
              Vec <a href="#ae5b03da1529a27964723627bceb43166" class="m-doc-self">witness_vec</a>
            </dt>
            <dd>witness vector</dd>
            <dt id="ad30dd7a02d63bd650296fb0d23878103">
              const size_t <a href="#ad30dd7a02d63bd650296fb0d23878103" class="m-doc-self">_n</a>
            </dt>
            <dd>dimension</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="a43322b727396f7fbc3ef48eeac133096"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a43322b727396f7fbc3ef48eeac133096" class="m-doc-self">LDLTMgr</a>(</span><span class="m-doc-wrap">size_t N) <span class="m-label m-info">explicit</span> </span></span>
            </h3>
            <p>Construct a new ldlt ext object.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">N&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>dimension</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a2af45dc9628f487ab821aff6f3fc0794"><div>
            <h3>
              <div class="m-doc-template">
                template&lt;typename Mat&gt;
              </div>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a2af45dc9628f487ab821aff6f3fc0794" class="m-doc-self">factorize</a>(</span><span class="m-doc-wrap">const Mat&amp; A) -&gt; bool</span></span>
            </h3>
            <p>Perform LDLT Factorization.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">A&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Symmetric <a href="class_matrix.html" class="m-doc">Matrix</a></td>
                </tr>
              </tbody>
            </table>
<p>The <code>factorize</code> function is a template function that takes a symmetric matrix <code>A</code> as input and performs the LDLT factorization on it. It calls the <code>factor</code> function with a lambda function as an argument. The lambda function takes the indices <code>i</code> and <code>j</code> and returns the element <code>A(i, j)</code> of the matrix <code>A</code>. The <code>factor</code> function performs the actual factorization using the provided lambda function. The <code>factorize</code> function returns a boolean value indicating whether the factorization was successful or not.</p>
          </div></section>
          <section class="m-doc-details" id="a9a0315be1e868d82b607be9feb3c1f47"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a9a0315be1e868d82b607be9feb3c1f47" class="m-doc-self">factor</a>(</span><span class="m-doc-wrap">std::function&lt;double(size_t, size_t)&gt; get_matrix_elem) -&gt; bool</span></span>
            </h3>
            <p>Perform LDLT Factorization (Lazy evaluation)</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">get_matrix_elem&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>function to access the elements of A</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>true</td>
                </tr>
              </tfoot>
            </table>
<p>See also: <a href="class_l_d_l_t_mgr.html#a2af45dc9628f487ab821aff6f3fc0794" class="m-doc">factorize()</a></p>
          </div></section>
          <section class="m-doc-details" id="afc994e7c46e9c9bd159ab066e8393c24"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#afc994e7c46e9c9bd159ab066e8393c24" class="m-doc-self">factor_with_allow_semidefinite</a>(</span><span class="m-doc-wrap">std::function&lt;double(size_t, size_t)&gt; get_matrix_elem) -&gt; bool</span></span>
            </h3>
            <p>Perform LDLT Factorization (Lazy evaluation)</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">get_matrix_elem&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>function to access the elements of A</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>true</td>
                </tr>
              </tfoot>
            </table>
<p>See also: <a href="class_l_d_l_t_mgr.html#a2af45dc9628f487ab821aff6f3fc0794" class="m-doc">factorize()</a></p>
          </div></section>
          <section class="m-doc-details" id="a0a2d047ce3d930da880474c9a4aff9f2"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a0a2d047ce3d930da880474c9a4aff9f2" class="m-doc-self">is_spd</a>(</span><span class="m-doc-wrap">) const noexcept -&gt; bool</span></span>
            </h3>
            <p>Is $A$ symmetric positive definite (spd)</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>true</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
          <section class="m-doc-details" id="a0c2f0d8bd99e16c64103b5d1da966dcb"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a0c2f0d8bd99e16c64103b5d1da966dcb" class="m-doc-self">witness</a>(</span><span class="m-doc-wrap">) -&gt; double</span></span>
            </h3>
            <p>witness that certifies $A$ is not symmetric positive definite (spd)</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>double</td>
                </tr>
              </tfoot>
            </table>
<p>The <code><a href="class_l_d_l_t_mgr.html#a0c2f0d8bd99e16c64103b5d1da966dcb" class="m-doc">witness()</a></code> function calculates a witness that certifies that the matrix <code>A</code> is not symmetric positive definite (spd). It returns a <code>double</code> value that represents the witness.</p>
          </div></section>
          <section class="m-doc-details" id="a3a8724268ebae4c5a9183f8acb0742f1"><div>
            <h3>
              <div class="m-doc-template">
                template&lt;typename Arr036&gt;
              </div>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a3a8724268ebae4c5a9183f8acb0742f1" class="m-doc-self">set_witness_vec</a>(</span><span class="m-doc-wrap">Arr036&amp; v) const -&gt; void</span></span>
            </h3>
            <p>Set the witness vec object.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Template parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">Arr036</td>
                  <td></td>
                </tr>
              </tbody>
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td>v</td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="af67c2bccbf77125b4f7a2daa15a05024"><div>
            <h3>
              <div class="m-doc-template">
                template&lt;typename Mat&gt;
              </div>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#af67c2bccbf77125b4f7a2daa15a05024" class="m-doc-self">sym_quad</a>(</span><span class="m-doc-wrap">const Mat&amp; A) const -&gt; double</span></span>
            </h3>
            <p>Calculate v&#x27;*{A}(p,p)*v.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Template parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">Mat</td>
                  <td></td>
                </tr>
              </tbody>
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td>A&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td></td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>double</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
          <section class="m-doc-details" id="a7bbba061b1b4ded4cdfca5bf55f3068b"><div>
            <h3>
              <div class="m-doc-template">
                template&lt;typename Mat&gt;
              </div>
              <span class="m-doc-wrap-bumper">auto LDLTMgr::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a7bbba061b1b4ded4cdfca5bf55f3068b" class="m-doc-self">sqrt</a>(</span><span class="m-doc-wrap">Mat&amp; M) -&gt; void</span></span>
            </h3>
            <p>Return upper triangular matrix $R$ where $A = R^T R$.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Template parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">Mat</td>
                  <td></td>
                </tr>
              </tbody>
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td>M&nbsp;<span class="m-label m-flat m-danger">in/out</span></td>
                  <td></td>
                </tr>
              </tbody>
            </table>
<p>The <code>sqrt</code> function calculates the square root of a symmetric positive definite matrix <code>M</code>. It assumes that <code>M</code> is a zero matrix and calculates the upper triangular matrix <code>R</code> such that <code>M = R^T * R</code>.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>EllAlgo. Created with <a href="https://doxygen.org/">Doxygen</a> 1.9.7 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
